/* *
 * year-month-date-selector-plugin v1.0.1 @sh
 * https://github.com/shuliu/yearMonthDateSelector
 * */
$.fn.yearMonthDateSelector=function(e){var t=this,i={year:$(this).find("select:eq(0)"),month:$(this).find("select:eq(1)"),date:$(this).find("select:eq(2)"),formatYear:"西元{{year}}年",formatMonth:"{{month}}月",formatDate:"{{date}}日",maxYear:null,minYear:1900};$.extend(i,e),t._init=function(){if(1!==i.year.length||1!==i.month.length||1!==i.date.length)return window.console&&console.log("無法取得元素"),!1;t.setYearOption(),0===i.month.find("option").length&&t.setMonthOption(),0===i.date.find("option").length&&t.setDateOption()},t._initEvent=function(){i.year.unbind("change").on("change",function(){t.setMonthOption(),t.setDateOption()}),i.month.unbind("change").on("change",function(){t.setDateOption()})},t.setYearOption=function(){if((isNaN(i.maxYear)||i.maxYear>(new Date).getFullYear()||i.maxYear<i.minYear)&&(i.maxYear=(new Date).getFullYear()),0===i.year.find("option").length||i.year.find("option:eq(0)").val()!==i.maxYear||i.year.find("option:eq(-1)").val()!==i.minYear){i.month.empty(),i.year.append($("<option>").val("").text("西元年"));for(var e=i.maxYear;e>=i.minYear;e--)i.year.append($("<option>").val(e).text(i.formatYear.replace(/{{year}}/g,e)))}},t.setMonthOption=function(){if(i.month.find("option").length<12){i.month.empty(),i.month.append($("<option>").val("").text("月份"));for(var e=1;e<=12;e++)i.month.append($("<option>").val(e).text(i.formatMonth.replace(/{{month}}/g,e)))}},t.setDateOption=function(){var e=parseInt(i.year.val(),10),t=parseInt(i.month.val(),10),n=parseInt(i.date.val(),10);if(isNaN(t)||isNaN(e))return i.date.empty(),i.date.append($("<option>").val("").text("日期")),!1;var a=31;4===t||6===t||9===t||11===t?a=30:2===t&&(a=e%4!=0||e%100==0&&e%400!=0?28:29),i.date.empty();for(var o=1;o<=a;o++)i.date.append($("<option>").val(o).text(i.formatDate.replace(/{{date}}/g,o)));i.date.find("option:eq("+(n<a?n-1:a-1)+")").prop("selected",!0)},this.setYearValue=function(){$(i.year).val(i.year.data("val")).trigger("change")},this.setMonthValue=function(){$(i.month).val(i.month.data("val")).trigger("change")},this.setDateValue=function(){$(i.date).val(i.date.data("val")).trigger("change")},$.when(t._init(),t._initEvent(),t.setYearValue(),t.setMonthValue(),t.setDateValue(),$.Deferred(function(e){return $(e.resolve)})).done(function(){console.log("ready")})};